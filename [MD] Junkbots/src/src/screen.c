#include "../inc/include.h"


static u16 xscroll_b[28] = {};
static u32 _counter = 0;


void screen_title()
{
   SPR_clear();
   SPR_update(sprites, MAX_SPRITE);
   SPR_end ( );

   VDP_clearPlan ( VDP_PLAN_B, 0 );
   VDP_clearPlan ( VDP_PLAN_B, 0 );

   _counter = 0;


   VDP_setPalette ( PAL0, palette_grey );
   VDP_setPalette(PAL1,title_image.palette);
   u16 ind = TILE_USERINDEX+300;
   VDP_drawImageEx(BPLAN, &title_image, TILE_ATTR_FULL(PAL1, FALSE, FALSE, FALSE, ind), 0, 0, TRUE, TRUE);




   VDP_drawText ( "@slapmybitsup  &  @MoonWatcherMD",     4, 22);
   VDP_drawText ( "For @bitbitjam 2014",     10, 25);

   while ( true )
   {
      u16 pressed = JOY_readJoypad ( JOY_1 );

      if ( pressed & BUTTON_BTN )
      {
         break;
      }


      if ( _counter % 5 == 0 )
      {
         ++xscroll_b[0];
         ++xscroll_b[1];
         ++xscroll_b[2];
      }

      if ( _counter % 6 == 0 )
      {
         ++xscroll_b[3];
         ++xscroll_b[4];
         ++xscroll_b[5];
      }

      VDP_setScrollingMode ( HSCROLL_TILE, VSCROLL_PLANE );
      VDP_setHorizontalScrollTile(PLAN_B , 0, xscroll_b, 6, 1);

      VDP_waitVSync();
      ++_counter;
   }

   VDP_fadeOutAll(10,0);
   waitMs(1000);
}


void screen_gameover ( bool congrats )
{
   SPR_clear();
   SPR_update(sprites, MAX_SPRITE);
   SPR_end ( );

   VDP_clearPlan ( VDP_PLAN_B, 0 );
   VDP_clearPlan ( VDP_PLAN_B, 0 );

   VDP_setScrollingMode ( HSCROLL_PLANE, VSCROLL_PLANE );
   VDP_setHorizontalScroll(PLAN_B , 0);
   VDP_setHorizontalScroll(PLAN_A , 0);

   VDP_setPalette ( PAL0, palette_grey );
   VDP_setPalette ( PAL1, gameover_image.palette );
   u16 ind = TILE_USERINDEX+300;
   VDP_drawImageEx ( BPLAN, &gameover_image, TILE_ATTR_FULL(PAL1, FALSE, FALSE, FALSE, ind), 0, 0, TRUE, TRUE );


   if ( congrats )
   {
      VDP_drawText ( "That was good.",     11, 12);
      VDP_drawText ( "You found the evidence", 11, 14);
      VDP_drawText ( "to prove the conspiracy", 11, 16);
      VDP_drawText ( "on the theme of ",        11, 18);
      VDP_drawText ( "#bitbitjam",             11, 20);

      VDP_drawText ( "Now go and spread the ", 11, 23);
      VDP_drawText ( "word.", 11, 25);

   }
   else
   {
      VDP_drawText ( "Not good enough,",     11, 14);
      VDP_drawText ( "too bad indeed, pal.", 11, 16);

      VDP_drawText ( "May you should try with", 11, 19);
      VDP_drawText ( "others #bitbitjam",       11, 21);
      VDP_drawText ( "entries",                 11, 23);
   }

   JOY_waitPressBtn();
}


void screen_sega ( u16 secs, u16 buttons, u8 on_release  )
{
//	#define LINES 36
//
//	tool_reset();
//	tool_resetSprites();
//	music_stop();
//
//	u8 vel = IS_PALSYSTEM ? 50 : 60;
//
//	struct _logo { u16 pal[16], wait; };
//
//	const struct _logo logo[LINES] =
//	{
//		//   UNUSED       2       3       4       5       6       7       8       9  UNUSED      11      12      13      14      15      16    WAIT
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0FFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0777, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0FFF, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0333, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0333, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0333, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0333, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0777, 0x0333, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0333, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  500 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0EA0 },  100 }, // 10
//		{  { 0x0000, 0x0000, 0x0000, 0x0EA0, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0E60 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0E60, 0x0000, 0x0EA0, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0A20 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0A20, 0x0000, 0x0E60, 0x0000, 0x0EA0, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0600, 0x0000, 0x0A20, 0x0EA0, 0x0E60, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0EA0, 0x0600, 0x0E60, 0x0A20, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0000, 0x0EA0, 0x0000, 0x0E60, 0x0000, 0x0A20, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0EA0, 0x0E60, 0x0000, 0x0A20, 0x0000, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0E60, 0x0A20, 0x0000, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0A20, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 },
//		{  { 0x0000, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  100 }, // 20
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  500 },
//		{  { 0x0000, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0200 },  100 },
//		{  { 0x0000, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0400 },  100 },
//		{  { 0x0000, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0600, 0x0600, 0x0900, 0x0920, 0x0920, 0x0920, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0600, 0x0900, 0x0920, 0x0B20, 0x0940, 0x0B70, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0B70, 0x0D90, 0x0222, 0x0000, 0x0222, 0x0222, 0x0222, 0x0222, 0x0222, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0E90, 0x0EB0, 0x0333, 0x0000, 0x0333, 0x0333, 0x0333, 0x0333, 0x0333, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0444, 0x0000, 0x0444, 0x0444, 0x0444, 0x0444, 0x0444, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0676, 0x0000, 0x0676, 0x0676, 0x0676, 0x0676, 0x0676, 0x0600 },  100 }, // 30
//		{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0999, 0x0000, 0x0999, 0x0999, 0x0999, 0x0999, 0x0999, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0DDD, 0x0000, 0x0DDD, 0x0DDD, 0x0DDD, 0x0DDD, 0x0DDD, 0x0600 },  100 },
//		{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0FFF, 0x0000, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0600 }, 4000 },
//		{  { 0x0000, 0x0400, 0x0400, 0x0600, 0x0920, 0x0940, 0x0940, 0x0970, 0x0999, 0x0000, 0x0999, 0x0999, 0x0999, 0x0999, 0x0999, 0x0400 },  100 },
//		{  { 0x0000, 0x0200, 0x0200, 0x0400, 0x0400, 0x0620, 0x0420, 0x0640, 0x0676, 0x0000, 0x0676, 0x0676, 0x0676, 0x0676, 0x0676, 0x0200 },  100 },
//		{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  500 },
//	};
//
//	tool_showBmp ( PAL1, (GenResTiles*) &ob_logo_Sega, HOW_TO_PLAY_TILE, APLAN, 14, 12, 0 );
//
//	u8 x, i;
//
//	for ( x=0; x<LINES; ++x )
//	{
//		for ( i=0; i<16; i++ )
//		{
//			VDP_setPaletteColor ( i, logo[x].pal[i] );
//		}
//
//		if ( _wait_hz( logo[x].wait * vel / 1000, buttons, on_release ) )
//		{
//			return;
//		}
//	}
//
//	_wait ( secs, buttons, on_release ); // NONSENSE
}

